"0",""
"0","library(RPostgreSQL)"
"0",""
"0","drv <- dbDriver(""PostgreSQL"")"
"0","conn <- dbConnect(drv,dbname=""bderamo2021_gold"", host=""10.200.31.73"",port=5432,user=""eramo_gold"",password=""ERAMO_GOLD"")"
"0",""
"0","datos <- dbGetQuery(conn,""Select reeg, sum(frec) as frec"
"0","from"
"0","(select b.descrip as reeg, count(*) as frec"
"0","	from explotacion.agropecuario a"
"0","	join catalogos.si_no b"
"0","	on a.registro_a = b.gid"
"0","	where registro_a In(1,2) and cuest_pecuario = 0"
"0","	group by b.descrip"
"0","union all"
"0","	select b.descrip as reeg, count(*) as frec"
"0","	from explotacion.agropecuario a"
"0","	join catalogos.si_no b"
"0","	on a.registro_p = b.gid"
"0","	where registro_p In(1,2) and cuest_agricola = 0"
"0","	group by b.descrip"
"0"," union all"
"0","	select b.descrip as reeg, count(*) as frec"
"0","	from explotacion.agropecuario a"
"0","	join catalogos.si_no b"
"0","	on a.registro_p = b.gid"
"0","	where registro_p In(1,2) and cuest_agricola = 1 and cuest_pecuario = 1"
"0","	group by b.descrip"
"0",") as query"
"0","group by reeg"");"
"0","	"
"0","library(plotly)"
"0",""
"0","data <- datos[,c('reeg', 'frec')]"
"0","colors <- colorRampPalette(c(""#68912B"",""#AB7A5A""))(2)"
"0","fig <- plot_ly(data, labels = ~reeg, values = ~frec, type = 'pie',"
"0","textposition = 'outside',"
"0","textinfo = 'percent', "
"0","insidetextfont = list(color = '#FFFFFF'),"
"0","hoverinfo = 'text',"
"0","text = ~paste('',reeg , ''),"
"0","marker = list(colors = colors,"
"0","line = list(color = '#FFFFFF', width = 1)), showlegend = TRUE)"
"0",""
"0","fig <- fig %>% layout(title = '',"
"0","xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE),"
"0","yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE))"
"0",""
"0","#1.1.a. Procesos en los que las UP declaran llevar registro del manejo o p√©rdida de alimentos"
"0",""
"0","#dbDisconnect(conn)"
"0",""
"0","fig"
