"0",""
"0",""
"0","#library(RPostgreSQL) "
"0",""
"0","#drv <- dbDriver(""PostgreSQL"") "
"0",""
"0","#conn <- dbConnect(drv,dbname=""bderamo2021_gold"", host=""10.200.31.73"",port=5432,user=""eramo_gold"",password=""ERAMO_GOLD"") "
"0",""
"0","datos <- dbGetQuery(conn,""select producto, manejo, perdida, round(perdida/manejo*100,2) porcent_perdida"
"0","from"
"0","("
"0","select b.descrip producto, a.manejo_kg_e manejo, a.perdida_kg_e perdida"
"0","from explotacion.productos_establecimientos a"
"0","join catalogos.prod_establecimientos b"
"0","on a.producto_e = b.gid and b.descrip not in ('Otro producto 1', 'Otro producto 2', 'Otro producto 3')"
"0","union all"
"0","select nombre_otro_prod producto, manejo_kg_e manejo, perdida_kg_e perdida"
"0","from explotacion.productos_establecimientos"
"0","where producto_e in (135, 136, 137)"
"0",") as query"
"0","order by porcent_perdida desc;"")"
"0",""
"0",""
"0","library(plotly)"
"0",""
"0","colors <- colorRampPalette(c(""#68912B"",""#AB7A5A""))"
"0",""
"0","data <- datos[,c('producto', 'porcent_perdida')]"
"0","fig <- plot_ly(data, x = ~producto, y = ~porcent_perdida, type = 'box', color = ~producto,"
"0","               marker = list(colors = colors))"
"0","fig <- fig %>% layout(title=(""""),"
"0","                      xaxis = list(showgrid = TRUE, zeroline = TRUE, showticklabels = FALSE, title = ""Producto"", categoryorder = ""total descending""),"
"0","                      yaxis = list(showgrid = TRUE, zeroline = TRUE, showticklabels = TRUE, title = ""Porcentaje del desperdicio""))"
"0",""
"0","#list(title = ""Productos"""
"0","#list(title = ""Frecuencia"""
"0","#dbDisconnect(conn)"
"0",""
"0","fig"
