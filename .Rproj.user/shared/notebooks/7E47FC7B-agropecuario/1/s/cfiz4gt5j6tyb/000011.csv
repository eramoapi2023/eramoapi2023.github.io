"0",""
"0","#library(RPostgreSQL)"
"0","#drv <- dbDriver(""PostgreSQL"")"
"0","#conn <- dbConnect(drv,dbname=""bderamo2021_gold"", host=""10.200.31.73"",port=5432,user=""eramo_gold"",password=""ERAMO_GOLD"")"
"0",""
"0","#datos <- dbGetQuery(conn,""Select *"
"0","#From explotacion.prod_pecuarios_14b"");"
"0",""
"0","datos <- dbGetQuery(conn,""Select producto, sum(frec) frec"
"0","From"
"0","  (select prod.descrip producto, count(*) frec"
"0","   from explotacion.productos_pecuario pda join catalogos.prod_pecuario prod on pda.producto_p = prod.gid"
"0","   where prod.descrip not in ('Otro producto 1', 'Otro producto 2', 'Otro producto 3')"
"0","   group by prod.descrip"
"0","union"
"0","   select nom_otro_producto_p producto, count(*) frec"
"0","   from explotacion.productos_pecuario"
"0","   where producto_p = 991 and nom_otro_producto_p <> 'NE'"
"0","   group by nom_otro_producto_p"
"0","union"
"0","   select nom_otro_producto_p producto, count(*) frec"
"0","   from explotacion.productos_pecuario"
"0","   where producto_p = 992 and nom_otro_producto_p <> 'NE'"
"0","   group by nom_otro_producto_p"
"0","union"
"0","   select nom_otro_producto_p producto, count(*) frec"
"0","   from explotacion.productos_pecuario"
"0","   where producto_p = 993 and nom_otro_producto_p <> 'NE'"
"0","   group by nom_otro_producto_p) as query"
"0","group by producto"
"0","order by frec, producto"");"
"0",""
"0","library(plotly)"
"0","data <- datos[,c('producto', 'frec')]"
"0","fig <- plot_ly(data, x = ~producto, y = ~frec, type = 'bar', "
"0","      marker = list(color = '#AB7A5A'))"
"0",""
"0","fig <- fig %>% layout(title=(""1.4.b. Productos criados, cultivados, recolectados y/o<br> por las Unidades de Producci√≥n Pecuaria""),"
"0","xaxis = list(title = ""Producto"", categoryorder = ""total descending""),"
"0","yaxis = list(title = ""Frecuencia""))"
"0",""
"0","#dbDisconnect(conn)"
"0",""
"0","fig"
